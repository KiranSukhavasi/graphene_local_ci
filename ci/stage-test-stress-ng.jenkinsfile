stage('stress-ng') {
    try {
        timeout(time: 180, unit: 'MINUTES') {
            sh '''
                export cmd=graphene-direct
                cd Examples/stress-ng
                if test -n "$SGX"
                then
                    make SGX=1
                    export cmd=graphene-sgx
                else
                    make
                fi

                $cmd stress-ng --job hdd.job 2>&1 | tee hdd.log
                $cmd stress-ng --job seek.job 2>&1 | tee seek.log
                $cmd stress-ng --job seek-hdd.job 2>&1 | tee seek-hdd.log
                $cmd stress-ng --job interrupt.job 2>&1 | tee interrupt.log
                $cmd stress-ng --job filesystem.job 2>&1 | tee filesystem.log
                $cmd stress-ng --job filesystem_all.job 2>&1 | tee filesystem_all.log
                $cmd stress-ng --job scheduler.job 2>&1 | tee scheduler.log
                $cmd stress-ng --job scheduler_all.job 2>&1 | tee scheduler_all.log

            '''
        }
    } catch (Exception e){
        build_ok = false
        sh 'echo "Stress-ng Failed"'
    } finally {
        archiveArtifacts 'Examples/stress-ng/*.log'
    }
}
            
